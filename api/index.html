<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://ring.com/api/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>API - ring</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../css/ansi-colours.css" rel="stylesheet" />
        <link href="../css/jupyter-cells.css" rel="stylesheet" />
        <link href="../css/pandas-dataframe.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "API";
        var mkdocs_page_input_path = "api.md";
        var mkdocs_page_url = "/api/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../img/icon.svg" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../xml_syntax/">XML Syntax Documentation</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">API</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#ring">RING</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#src.ring.RING">RING</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#src.ring.ml.ringnet.RING">RING</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#rcmg">RCMG</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#src.ring.algorithms.generator.base.RCMG">RCMG</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#system">System</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#src.ring.base.System">System</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#motionconfig">MotionConfig</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#src.ring.algorithms.jcalc.MotionConfig">MotionConfig</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#src.ring.algorithms.jcalc.join_motionconfigs">join_motionconfigs</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#extending-the-rcmg">Extending the RCMG</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#src.ring.algorithms.jcalc.JointModel">JointModel</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#src.ring.algorithms.jcalc.register_new_joint_type">register_new_joint_type</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#simulation">Simulation</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#src.ring.base.State">State</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#src.ring.algorithms.dynamics.step">step</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#src.ring.base.Transform">Transform</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Examples / Notebooks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/getting_started/">Getting started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/batched_simulation/">Batched simulation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/control/">Control</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/custom_joint_type/">Custom joint type</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/experimental_data/">Experimental data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/error_quaternion/">Error quaternion</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/machine_learning/">Machine learning</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/visualisation/">Visualisation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/knee_angle_tracking/">Knee angle tracking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/interactive_viewer/">Interactive viewer</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">ring</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">API</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="api">API<a class="headerlink" href="#api" title="Permanent link">¤</a></h1>
<h2 id="ring">RING<a class="headerlink" href="#ring" title="Permanent link">¤</a></h2>



<div class="doc doc-object doc-function">



<h4 id="src.ring.RING" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">RING</span>


<a href="#src.ring.RING" class="headerlink" title="Permanent link">¤</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">RING</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">Ts</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents first">
  
      <p>Creates the RING network.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>lam</code></b>
                  (<code>list[int] | None</code>)
              –
              <div class="doc-md-description">
                <p>parent array, if <code>None</code> must be given via <code>ringnet.apply(..., lam=lam)</code></p>
              </div>
            </li>
            <li>
              <b><code>Ts</code></b>
              –
              <div class="doc-md-description">
                <p>sampling interval of IMU data; time delta in seconds</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
                <code><span title="src.ring.ml.AbstractFilter">AbstractFilter</span></code>
            –
            <div class="doc-md-description">
              <p>ring.ml.AbstractFilter: An instantiation of <code>ring.ml.ringnet.RING</code> with trained
parameters.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>


<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ring</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span>  <span class="p">:</span> <span class="nb">int</span>       <span class="o">=</span> <span class="mi">30</span>         <span class="c1"># sequence length     [s]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ts</span> <span class="p">:</span> <span class="nb">float</span>     <span class="o">=</span> <span class="mf">0.01</span>       <span class="c1"># sampling interval   [s]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span>  <span class="p">:</span> <span class="nb">int</span>       <span class="o">=</span> <span class="mi">1</span>          <span class="c1"># batch size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lam</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># parent array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span>  <span class="p">:</span> <span class="nb">int</span>       <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>   <span class="c1"># number of bodies</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T_i</span><span class="p">:</span> <span class="nb">int</span>       <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Ts</span><span class="p">)</span>  <span class="c1"># number of timesteps</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">B</span><span class="p">,</span> <span class="n">T_i</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># where X is structured as follows:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># X[..., :3]  = acc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># X[..., 3:6] = gyr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># X[..., 6:9] = jointaxis</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># let&#39;s assume we have an IMU on each outer segment of the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># three-segment kinematic chain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="o">=</span> <span class="n">acc_segment1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="o">=</span> <span class="n">acc_segment3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">gyr_segment1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">gyr_segment3</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ringnet</span> <span class="o">=</span> <span class="n">ring</span><span class="o">.</span><span class="n">RING</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yhat</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ringnet</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># yhat : unit quaternions, shape = (B, T_i, N, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># yhat[b, :, i] is the orientation from body `i` to parent body `lam[i]`</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use `jax.jit` to compile the forward pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jit_apply</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">ringnet</span><span class="o">.</span><span class="n">apply</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yhat</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">jit_apply</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># manually pass in and out the hidden state like so</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_state</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yhat</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">ringnet</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># state: final hidden state, shape = (B, N, 2*H)</span>
</code></pre></div>

  </div>

</div><hr />


<div class="doc doc-object doc-class">



<h4 id="src.ring.ml.ringnet.RING" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">RING</span>


<a href="#src.ring.ml.ringnet.RING" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents first">



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="src.ring.ml.ringnet.RING.__init__" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#src.ring.ml.ringnet.RING.__init__" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forward_factory</span><span class="o">=</span><span class="n">make_ring</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Untrained RING network</p>

  </div>

</div>



  </div>

  </div>


</div><h2 id="rcmg">RCMG<a class="headerlink" href="#rcmg" title="Permanent link">¤</a></h2>


<div class="doc doc-object doc-class">



<h4 id="src.ring.algorithms.generator.base.RCMG" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">RCMG</span>


<a href="#src.ring.algorithms.generator.base.RCMG" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents first">



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="src.ring.algorithms.generator.base.RCMG.__init__" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#src.ring.algorithms.generator.base.RCMG.__init__" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">jcalc</span><span class="o">.</span><span class="n">MotionConfig</span><span class="p">(),</span> <span class="n">setup_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">finalize_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_X_imus</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_X_imus_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">add_X_jointaxes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_X_jointaxes_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">add_y_relpose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_y_rootincl</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_y_rootincl_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">add_y_rootfull</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_y_rootfull_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">sys_ml</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">randomize_positions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">randomize_motion_artifacts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">randomize_joint_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">randomize_hz</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">randomize_hz_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">imu_motion_artifacts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">imu_motion_artifacts_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">dynamic_simulation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dynamic_simulation_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">output_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep_output_extras</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_link_number_in_Xy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cor</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Initializes the Random Chain Motion Generator (RCMG).</p>
<p>The RCMG generates synthetic joint motion sequences for kinematic and dynamic
systems based on predefined motion configurations. It allows for system
randomization, augmentation with IMU and joint axis data, and optional
dynamic simulation.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>sys</code></b>
                  (<code><span title="ring.base.System">System</span> | list[<span title="ring.base.System">System</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The system(s) for which motion should be generated.</p>
              </div>
            </li>
            <li>
              <b><code>config</code></b>
                  (<code><span title="ring.algorithms.jcalc.MotionConfig">MotionConfig</span> | list[<span title="ring.algorithms.jcalc.MotionConfig">MotionConfig</span>]</code>, default:
                      <code><span title="ring.algorithms.jcalc.MotionConfig">MotionConfig</span>()</code>
)
              –
              <div class="doc-md-description">
                <p>Motion configuration(s) defining velocity limits, interpolation methods,
and range constraints. Defaults to <code>jcalc.MotionConfig()</code>.</p>
              </div>
            </li>
            <li>
              <b><code>setup_fn</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="ring.algorithms.generator.types.SETUP_FN">SETUP_FN</span>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>A function to modify the system before motion generation. Defaults to <code>None</code>.</p>
              </div>
            </li>
            <li>
              <b><code>finalize_fn</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="ring.algorithms.generator.types.FINALIZE_FN">FINALIZE_FN</span>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>A function to modify outputs after motion generation. Defaults to <code>None</code>.</p>
              </div>
            </li>
            <li>
              <b><code>add_X_imus</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to add IMU sensor data to the output. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>add_X_imus_kwargs</code></b>
                  (<code>dict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments for IMU data processing. Defaults to <code>{}</code>.</p>
              </div>
            </li>
            <li>
              <b><code>add_X_jointaxes</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to add joint axis data to the output. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>add_X_jointaxes_kwargs</code></b>
                  (<code>dict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments for joint axis data processing. Defaults to <code>{}</code>.</p>
              </div>
            </li>
            <li>
              <b><code>add_y_relpose</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to add relative pose targets to the output. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>add_y_rootincl</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to add root inclination targets to the output. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>add_y_rootincl_kwargs</code></b>
                  (<code>dict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments for root inclination processing. Defaults to <code>{}</code>.</p>
              </div>
            </li>
            <li>
              <b><code>add_y_rootfull</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to add full root state targets to the output. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>add_y_rootfull_kwargs</code></b>
                  (<code>dict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments for full root state processing. Defaults to <code>{}</code>.</p>
              </div>
            </li>
            <li>
              <b><code>sys_ml</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="ring.base.System">System</span>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>System that defines the graph and naming structure of the <code>X</code> and <code>y</code> outputs. Defaults to <code>None</code> which then uses the first provided system.</p>
              </div>
            </li>
            <li>
              <b><code>randomize_positions</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to randomised positions based on <code>pos_min</code> and <code>pos_max</code>. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>randomize_motion_artifacts</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to randomize the IMU motion artifact simulation. This randomises the spring stiffness and spring damping parameters of the passive free joint that is added between nonrigid and rigid IMU. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>randomize_joint_params</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to randomize joint parameters by calling <code>JointModel.init_joint_params</code> before every sequence generation. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>randomize_hz</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to randomize the sampling frequency of the generated data. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>randomize_hz_kwargs</code></b>
                  (<code>dict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments for sampling frequency randomization. Defaults to <code>{}</code>.</p>
              </div>
            </li>
            <li>
              <b><code>imu_motion_artifacts</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to simulate nonrigid IMU motion artifacts. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>imu_motion_artifacts_kwargs</code></b>
                  (<code>dict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments for IMU motion artifact simulation. Defaults to <code>{}</code>.</p>
              </div>
            </li>
            <li>
              <b><code>dynamic_simulation</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to use a physics-based simulation to generate motion instead of purely
kinematic methods. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>dynamic_simulation_kwargs</code></b>
                  (<code>dict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments for dynamic simulation. Defaults to <code>{}</code>.</p>
              </div>
            </li>
            <li>
              <b><code>output_transform</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>A function to transform the generated output data. Defaults to <code>None</code>.</p>
              </div>
            </li>
            <li>
              <b><code>keep_output_extras</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to keep additional output metadata. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>use_link_number_in_Xy</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to replace joint names with numerical indices in the output. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>cor</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to replace free joints with center-of-rotation (COR) 9D free joint. Defaults to <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>disable_tqdm</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to disable progress bars during generation. Defaults to <code>False</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>AssertionError</code>
              –
              <div class="doc-md-description">
                <p>If any of the provided <code>MotionConfig</code> instances are infeasible.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>This class supports batch generation, lazy and eager data loading, and
  motion augmentation.</li>
<li>If <code>randomize_hz=True</code>, the time step (<code>dt</code>) varies according to the specified
  sampling rates.</li>
<li>When <code>cor=True</code>, free joints are replaced with center-of-rotation models,
  affecting joint motion behavior.</li>
</ul>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.algorithms.generator.base.RCMG.to_lazy_gen" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">to_lazy_gen</span>


<a href="#src.ring.algorithms.generator.base.RCMG.to_lazy_gen" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">to_lazy_gen</span><span class="p">(</span><span class="n">sizes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">jit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a generator <code>X, y = gen(key)</code> that lazily generates batched sequences.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.algorithms.generator.base.RCMG.to_list" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">to_list</span>


<a href="#src.ring.algorithms.generator.base.RCMG.to_list" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">to_list</span><span class="p">(</span><span class="n">sizes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns list of unbatched sequences as numpy arrays.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.algorithms.generator.base.RCMG.to_folder" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">to_folder</span>


<a href="#src.ring.algorithms.generator.base.RCMG.to_folder" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">to_folder</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="s1">&#39;seq&#39;</span><span class="p">,</span> <span class="n">save_fn</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">pickle_save</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Stores unbatched sequences as numpy arrays into folder.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.algorithms.generator.base.RCMG.to_eager_gen" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">to_eager_gen</span>


<a href="#src.ring.algorithms.generator.base.RCMG.to_eager_gen" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">to_eager_gen</span><span class="p">(</span><span class="n">batchsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a generator <code>X, y = gen(key)</code> that returns precomputed batched sequences.</p>

  </div>

</div>



  </div>

  </div>


</div><h3 id="system">System<a class="headerlink" href="#system" title="Permanent link">¤</a></h3>


<div class="doc doc-object doc-class">



<h4 id="src.ring.base.System" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">System</span>


<a href="#src.ring.base.System" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents first">

  
      <p>Represents a robotic system consisting of interconnected links and joints. Create it using <code>System.create(...)</code></p>
<p>The <code>System</code> class models the kinematic and dynamic properties of a multibody
system, providing methods for state representation, transformations, joint
configuration management, and rendering. It supports both minimal and maximal
coordinate representations and can be parsed from or saved to XML files.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>link_parents</code></b>
                  (<code>list[int]</code>)
              –
              <div class="doc-md-description">
                <p>A list specifying the parent index for each link. The root link has a parent index of <code>-1</code>.</p>
              </div>
            </li>
            <li>
              <b><code>links</code></b>
                  (<code><span title="src.ring.base.Link">Link</span></code>)
              –
              <div class="doc-md-description">
                <p>A data structure containing information about all links in the system.</p>
              </div>
            </li>
            <li>
              <b><code>link_types</code></b>
                  (<code>list[str]</code>)
              –
              <div class="doc-md-description">
                <p>A list specifying the joint type for each link (e.g., "free", "hinge", "prismatic").</p>
              </div>
            </li>
            <li>
              <b><code>link_damping</code></b>
                  (<code><span title="jax.Array">Array</span></code>)
              –
              <div class="doc-md-description">
                <p>Joint damping coefficients for each link.</p>
              </div>
            </li>
            <li>
              <b><code>link_armature</code></b>
                  (<code><span title="jax.Array">Array</span></code>)
              –
              <div class="doc-md-description">
                <p>Armature inertia values for each joint.</p>
              </div>
            </li>
            <li>
              <b><code>link_spring_stiffness</code></b>
                  (<code><span title="jax.Array">Array</span></code>)
              –
              <div class="doc-md-description">
                <p>Stiffness values for joint springs.</p>
              </div>
            </li>
            <li>
              <b><code>link_spring_zeropoint</code></b>
                  (<code><span title="jax.Array">Array</span></code>)
              –
              <div class="doc-md-description">
                <p>Rest position of joint springs.</p>
              </div>
            </li>
            <li>
              <b><code>dt</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Simulation time step size.</p>
              </div>
            </li>
            <li>
              <b><code>geoms</code></b>
                  (<code>list[<span title="src.ring.base.Geometry">Geometry</span>]</code>)
              –
              <div class="doc-md-description">
                <p>List of geometries associated with the system.</p>
              </div>
            </li>
            <li>
              <b><code>gravity</code></b>
                  (<code><span title="jax.Array">Array</span></code>)
              –
              <div class="doc-md-description">
                <p>Gravity vector applied to the system (default: <code>[0, 0, -9.81]</code>).</p>
              </div>
            </li>
            <li>
              <b><code>integration_method</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Integration method for simulation (default: "semi_implicit_euler").</p>
              </div>
            </li>
            <li>
              <b><code>mass_mat_iters</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Number of iterations for mass matrix calculations.</p>
              </div>
            </li>
            <li>
              <b><code>link_names</code></b>
                  (<code>list[str]</code>)
              –
              <div class="doc-md-description">
                <p>Names of the links in the system.</p>
              </div>
            </li>
            <li>
              <b><code>model_name</code></b>
                  (<code><span title="typing.Optional">Optional</span>[str]</code>)
              –
              <div class="doc-md-description">
                <p>Name of the system model (if available).</p>
              </div>
            </li>
            <li>
              <b><code>omc</code></b>
                  (<code>list[<span title="src.ring.base.MaxCoordOMC">MaxCoordOMC</span> | None]</code>)
              –
              <div class="doc-md-description">
                <p>List of optional Maximal Coordinate representations.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.num_links" href="#src.ring.base.System.num_links">num_links</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Returns the number of links in the system.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.q_size" href="#src.ring.base.System.q_size">q_size</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Returns the total number of generalized coordinates (<code>q</code>) in the system.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.qd_size" href="#src.ring.base.System.qd_size">qd_size</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Returns the total number of generalized velocities (<code>qd</code>) in the system.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.name_to_idx" href="#src.ring.base.System.name_to_idx">name_to_idx</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str) -&gt; int:
Returns the index of a link given its name.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.idx_to_name" href="#src.ring.base.System.idx_to_name">idx_to_name</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>int, allow_world: bool = False) -&gt; str:
Returns the name of a link given its index. If <code>allow_world</code> is <code>True</code>,
returns <code>"world"</code> for index <code>-1</code>.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.idx_map" href="#src.ring.base.System.idx_map">idx_map</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str) -&gt; dict:
Returns a dictionary mapping link names to their indices for a specified type
(<code>"l"</code>, <code>"q"</code>, or <code>"d"</code>).</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.parent_name" href="#src.ring.base.System.parent_name">parent_name</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str) -&gt; str:
Returns the name of the parent link for a given link.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.change_model_name" href="#src.ring.base.System.change_model_name">change_model_name</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Optional[str] = None, prefix: Optional[str] = None, suffix: Optional[str] = None) -&gt; "System":
Changes the name of the system model.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.change_link_name" href="#src.ring.base.System.change_link_name">change_link_name</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str, new_name: str) -&gt; "System":
Renames a specific link.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.add_prefix_suffix" href="#src.ring.base.System.add_prefix_suffix">add_prefix_suffix</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Optional[str] = None, suffix: Optional[str] = None) -&gt; "System":
Adds both a prefix and suffix to all link names.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.freeze" href="#src.ring.base.System.freeze">freeze</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str | list[str]) -&gt; "System":
Freezes the specified link(s), making them immovable.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.unfreeze" href="#src.ring.base.System.unfreeze">unfreeze</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str, new_joint_type: str) -&gt; "System":
Unfreezes a frozen link and assigns it a new joint type.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.change_joint_type" href="#src.ring.base.System.change_joint_type">change_joint_type</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str, new_joint_type: str, **kwargs) -&gt; "System":
Changes the joint type of a specified link.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.joint_type_simplification" href="#src.ring.base.System.joint_type_simplification">joint_type_simplification</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str) -&gt; str:
Returns a simplified representation of the given joint type.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.joint_type_is_free_or_cor" href="#src.ring.base.System.joint_type_is_free_or_cor">joint_type_is_free_or_cor</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str) -&gt; bool:
Checks if a joint type is either "free" or "cor".</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.joint_type_is_spherical" href="#src.ring.base.System.joint_type_is_spherical">joint_type_is_spherical</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str) -&gt; bool:
Checks if a joint type is "spherical".</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.joint_type_is_free_or_cor_or_spherical" href="#src.ring.base.System.joint_type_is_free_or_cor_or_spherical">joint_type_is_free_or_cor_or_spherical</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str) -&gt; bool:
Checks if a joint type is "free", "cor", or "spherical".</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.findall_imus" href="#src.ring.base.System.findall_imus">findall_imus</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>bool = True) -&gt; list[str] | list[int]:
Finds all IMU sensors in the system.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.findall_segments" href="#src.ring.base.System.findall_segments">findall_segments</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>bool = True) -&gt; list[str] | list[int]:
Finds all non-IMU segments in the system.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.findall_bodies_to_world" href="#src.ring.base.System.findall_bodies_to_world">findall_bodies_to_world</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>bool = False) -&gt; list[int] | list[str]:
Returns all bodies directly connected to the world.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.find_body_to_world" href="#src.ring.base.System.find_body_to_world">find_body_to_world</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>bool = False) -&gt; int | str:
Returns the root body connected to the world.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.findall_bodies_with_jointtype" href="#src.ring.base.System.findall_bodies_with_jointtype">findall_bodies_with_jointtype</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str, names: bool = False) -&gt; list[int] | list[str]:
Returns all bodies with the specified joint type.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.children" href="#src.ring.base.System.children">children</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str, names: bool = False) -&gt; list[int] | list[str]:
Returns the direct children of a given body.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.findall_bodies_subsystem" href="#src.ring.base.System.findall_bodies_subsystem">findall_bodies_subsystem</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str, names: bool = False) -&gt; list[int] | list[str]:
Finds all bodies in the subsystem rooted at a given link.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.scan" href="#src.ring.base.System.scan">scan</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Callable, in_types: str, *args, reverse: bool = False):
Iterates over system elements while applying a function.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.parse" href="#src.ring.base.System.parse">parse</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Parses the system, performing consistency checks and computing spatial inertia tensors.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.render" href="#src.ring.base.System.render">render</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Optional[Transform | list[Transform]] = None, **kwargs) -&gt; list[np.ndarray]:
Renders frames of the system using maximal coordinates.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.render_prediction" href="#src.ring.base.System.render_prediction">render_prediction</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Transform | list[Transform], yhat: dict | jax.Array | np.ndarray, **kwargs):
Renders a predicted state transformation.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.delete_system" href="#src.ring.base.System.delete_system">delete_system</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str | list[str], strict: bool = True):
Removes a subsystem from the system.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.make_sys_noimu" href="#src.ring.base.System.make_sys_noimu">make_sys_noimu</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Optional[list[str]] = None):
Returns a version of the system without IMU sensors.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.inject_system" href="#src.ring.base.System.inject_system">inject_system</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>"System", at_body: Optional[str] = None):
Merges another system into this one.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.morph_system" href="#src.ring.base.System.morph_system">morph_system</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Optional[list[int | str]] = None, new_anchor: Optional[int | str] = None):
Reorders the system’s link hierarchy.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.from_xml" href="#src.ring.base.System.from_xml">from_xml</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str, seed: int = 1) -&gt; "System":
Loads a system from an XML file.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.from_str" href="#src.ring.base.System.from_str">from_str</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str, seed: int = 1) -&gt; "System":
Loads a system from an XML string.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.to_str" href="#src.ring.base.System.to_str">to_str</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>bool = True) -&gt; str:
Serializes the system to an XML string.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.to_xml" href="#src.ring.base.System.to_xml">to_xml</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str) -&gt; None:
Saves the system as an XML file.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.create" href="#src.ring.base.System.create">create</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>str, seed: int = 1) -&gt; "System":
Creates a <code>System</code> instance from an XML file or string.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.System.coordinate_vector_to_q" href="#src.ring.base.System.coordinate_vector_to_q">coordinate_vector_to_q</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>jax.Array, custom_joints: dict[str, Callable] = {}) -&gt; jax.Array:
Converts a coordinate vector to minimal coordinates (<code>q</code>), applying
constraints such as quaternion normalization.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>AssertionError</code>
              –
              <div class="doc-md-description">
                <p>If the system structure is invalid (e.g., duplicate link names, incorrect parent-child relationships).</p>
              </div>
            </li>
            <li>
                  <code><span title="src.ring.base.InvalidSystemError">InvalidSystemError</span></code>
              –
              <div class="doc-md-description">
                <p>If an operation results in an inconsistent system state.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The system must be parsed before use to ensure consistency.</li>
<li>The system supports batch operations using JAX for efficient computations.</li>
<li>Joint types include revolute ("rx", "ry", "rz"), prismatic ("px", "py", "pz"), spherical, free, and more.</li>
<li>Inertial properties of links are computed automatically from associated geometries.</li>
</ul>
</details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.num_links" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">num_links</span>


<a href="#src.ring.base.System.num_links" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">num_links</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the number of links in the system.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.q_size" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">q_size</span>


<a href="#src.ring.base.System.q_size" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">q_size</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the total number of generalized coordinates (<code>q</code>) in the system.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.qd_size" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">qd_size</span>


<a href="#src.ring.base.System.qd_size" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">qd_size</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the total number of generalized velocities (<code>qd</code>) in the system.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.name_to_idx" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">name_to_idx</span>


<a href="#src.ring.base.System.name_to_idx" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">name_to_idx</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the index of a link given its name.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.idx_to_name" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">idx_to_name</span>


<a href="#src.ring.base.System.idx_to_name" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">idx_to_name</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">allow_world</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the name of a link given its index. If <code>allow_world</code> is <code>True</code>,
returns <code>"world"</code> for index <code>-1</code>.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.idx_map" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">idx_map</span>


<a href="#src.ring.base.System.idx_map" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">idx_map</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a dictionary mapping link names to their indices for a specified type
(<code>"l"</code>, <code>"q"</code>, or <code>"d"</code>).</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.parent_name" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">parent_name</span>


<a href="#src.ring.base.System.parent_name" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">parent_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the name of the parent link for a given link.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.change_model_name" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">change_model_name</span>


<a href="#src.ring.base.System.change_model_name" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">change_model_name</span><span class="p">(</span><span class="n">new_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Changes the name of the system model.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.change_link_name" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">change_link_name</span>


<a href="#src.ring.base.System.change_link_name" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">change_link_name</span><span class="p">(</span><span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Renames a specific link.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.add_prefix_suffix" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">add_prefix_suffix</span>


<a href="#src.ring.base.System.add_prefix_suffix" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">add_prefix_suffix</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Adds either or, or both a prefix and suffix to all link names.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.freeze" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">freeze</span>


<a href="#src.ring.base.System.freeze" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">freeze</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Freezes the specified link(s), making them immovable (uses <code>frozen</code> joint)</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.unfreeze" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">unfreeze</span>


<a href="#src.ring.base.System.unfreeze" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">unfreeze</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">new_joint_type</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Unfreezes a frozen link and assigns it a new joint type.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.change_joint_type" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">change_joint_type</span>


<a href="#src.ring.base.System.change_joint_type" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">change_joint_type</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">new_joint_type</span><span class="p">,</span> <span class="n">new_arma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_damp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_stif</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_zero</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Changes the joint type of a specified link.
By default damping, stiffness are set to zero.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.joint_type_simplification" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">joint_type_simplification</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.ring.base.System.joint_type_simplification" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">joint_type_simplification</span><span class="p">(</span><span class="n">typ</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a simplified name of the given joint type.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.joint_type_is_free_or_cor" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">joint_type_is_free_or_cor</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.ring.base.System.joint_type_is_free_or_cor" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">joint_type_is_free_or_cor</span><span class="p">(</span><span class="n">typ</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Checks if a joint type is either "free" or "cor".</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.joint_type_is_spherical" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">joint_type_is_spherical</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.ring.base.System.joint_type_is_spherical" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">joint_type_is_spherical</span><span class="p">(</span><span class="n">typ</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Checks if a joint type is "spherical".</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.joint_type_is_free_or_cor_or_spherical" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">joint_type_is_free_or_cor_or_spherical</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.ring.base.System.joint_type_is_free_or_cor_or_spherical" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">joint_type_is_free_or_cor_or_spherical</span><span class="p">(</span><span class="n">typ</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Checks if a joint type is "free", "cor", or "spherical".</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.findall_imus" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">findall_imus</span>


<a href="#src.ring.base.System.findall_imus" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">findall_imus</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Finds all IMU sensors in the system.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.findall_segments" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">findall_segments</span>


<a href="#src.ring.base.System.findall_segments" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">findall_segments</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Finds all non-IMU segments in the system.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.findall_bodies_to_world" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">findall_bodies_to_world</span>


<a href="#src.ring.base.System.findall_bodies_to_world" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">findall_bodies_to_world</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns all bodies directly connected to the world.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.find_body_to_world" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">find_body_to_world</span>


<a href="#src.ring.base.System.find_body_to_world" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">find_body_to_world</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the root body connected to the world.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.findall_bodies_with_jointtype" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">findall_bodies_with_jointtype</span>


<a href="#src.ring.base.System.findall_bodies_with_jointtype" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">findall_bodies_with_jointtype</span><span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns all bodies with the specified joint type.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.children" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">children</span>


<a href="#src.ring.base.System.children" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">children</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>List all direct children of body, does not include body itself</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.findall_bodies_subsystem" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">findall_bodies_subsystem</span>


<a href="#src.ring.base.System.findall_bodies_subsystem" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">findall_bodies_subsystem</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>List all children and children's children; does not include body itself</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.scan" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">scan</span>


<a href="#src.ring.base.System.scan" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">scan</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">in_types</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Scan <code>f</code> along each link in system whilst carrying along state.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>f</code></b>
                  (<code><span title="typing.Callable">Callable</span>[..., Y]</code>)
              –
              <div class="doc-md-description">
                <p>f(y: Y, *args) -&gt; y</p>
              </div>
            </li>
            <li>
              <b><code>in_types</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>string specifying the type of each input arg:
'l' is an input to be split according to link ranges
'q' is an input to be split according to q ranges
'd' is an input to be split according to qd ranges</p>
              </div>
            </li>
            <li>
              <b><code>args</code></b>
              –
              <div class="doc-md-description">
                <p>Arguments passed to <code>f</code>, and split to match the link.</p>
              </div>
            </li>
            <li>
              <b><code>reverse</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>If <code>true</code> from leaves to root. Defaults to False.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>ys</code></b>            –
            <div class="doc-md-description">
              <p>Stacked output y of f.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.parse" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">parse</span>


<a href="#src.ring.base.System.parse" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">parse</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Initial setup of system. System object does not work unless it is parsed.
Currently it does:
- some consistency checks
- populate the spatial inertia tensors
- check that all names are unique
- check that names are strings
- check that all pos_min &lt;= pos_max (unless traced)
- order geoms in ascending order based on their parent link idx
- check that all links have the correct size of
    - damping
    - armature
    - stiffness
    - zeropoint
- check that n_links == len(sys.omc)</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.render" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">render</span>


<a href="#src.ring.base.System.render" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">render</span><span class="p">(</span><span class="n">qs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">camera</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_pbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;mujoco&#39;</span><span class="p">,</span> <span class="n">render_every_nth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">scene_kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Render frames from system and trajectory of maximal coordinates <code>xs</code>.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>sys</code></b>
                  (<code><a class="autorefs autorefs-internal" title="src.ring.base.System" href="#src.ring.base.System">System</a></code>)
              –
              <div class="doc-md-description">
                <p>System to render.</p>
              </div>
            </li>
            <li>
              <b><code>xs</code></b>
                  (<code><a class="autorefs autorefs-internal" title="src.ring.base.Transform" href="#src.ring.base.Transform">Transform</a> | list[<a class="autorefs autorefs-internal" title="src.ring.base.Transform" href="#src.ring.base.Transform">Transform</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Single or time-series</p>
              </div>
            </li>
            <li>
              <b><code>show_pbar</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Whether or not to show a progress bar.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
                <code>list[<span title="numpy.ndarray">ndarray</span>]</code>
            –
            <div class="doc-md-description">
              <p>list[np.ndarray]: Stacked rendered frames. Length == len(xs).</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.render_prediction" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">render_prediction</span>


<a href="#src.ring.base.System.render_prediction" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">render_prediction</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">yhat</span><span class="p">,</span> <span class="n">transparent_segment_to_root</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p><code>xs</code> matches <code>sys</code>. <code>yhat</code> matches <code>sys_noimu</code>. <code>yhat</code> are child-to-parent.
Note that the body in yhat that connects to -1, is parent-to-child!</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.delete_system" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">delete_system</span>


<a href="#src.ring.base.System.delete_system" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">delete_system</span><span class="p">(</span><span class="n">link_name</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Cut subsystem starting at <code>link_name</code> (inclusive) from tree.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.make_sys_noimu" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_sys_noimu</span>


<a href="#src.ring.base.System.make_sys_noimu" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">make_sys_noimu</span><span class="p">(</span><span class="n">imu_link_names</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns, e.g., imu_attachment = {'imu1': 'seg1', 'imu2': 'seg3'}</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.inject_system" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">inject_system</span>


<a href="#src.ring.base.System.inject_system" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">inject_system</span><span class="p">(</span><span class="n">other_system</span><span class="p">,</span> <span class="n">at_body</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Combine two systems into one.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>sys</code></b>
                  (<code><a class="autorefs autorefs-internal" title="src.ring.base.System" href="#src.ring.base.System">System</a></code>)
              –
              <div class="doc-md-description">
                <p>Large system.</p>
              </div>
            </li>
            <li>
              <b><code>sub_sys</code></b>
                  (<code><a class="autorefs autorefs-internal" title="src.ring.base.System" href="#src.ring.base.System">System</a></code>)
              –
              <div class="doc-md-description">
                <p>Small system that will be included into the
large system <code>sys</code>.</p>
              </div>
            </li>
            <li>
              <b><code>at_body</code></b>
                  (<code><span title="typing.Optional">Optional</span>[str]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Into which body of the large system
small system will be included. Defaults to <code>worldbody</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
            –
            <div class="doc-md-description">
              <p>base.System: <em>description</em></p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.morph_system" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">morph_system</span>


<a href="#src.ring.base.System.morph_system" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">morph_system</span><span class="p">(</span><span class="n">new_parents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_anchor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Re-orders the graph underlying the system. Returns a new system.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>sys</code></b>
                  (<code><a class="autorefs autorefs-internal" title="src.ring.base.System" href="#src.ring.base.System">System</a></code>)
              –
              <div class="doc-md-description">
                <p>System to be modified.</p>
              </div>
            </li>
            <li>
              <b><code>new_parents</code></b>
                  (<code>list[int]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Let the i-th entry have value j. Then, after
morphing the system the system will be such that the link corresponding
to the i-th link in the old system will have as parent the link
corresponding to the j-th link in the old system.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
            –
            <div class="doc-md-description">
              <p>base.System: Modified system.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.from_xml" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_xml</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.ring.base.System.from_xml" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">from_xml</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Loads a system from an XML file.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.from_str" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_str</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.ring.base.System.from_str" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">from_str</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Loads a system from an XML string.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.to_str" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">to_str</span>


<a href="#src.ring.base.System.to_str" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">to_str</span><span class="p">(</span><span class="n">warn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Serializes the system to an XML string.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.to_xml" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">to_xml</span>


<a href="#src.ring.base.System.to_xml" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">to_xml</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Saves the system to an XML file.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.create" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">create</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#src.ring.base.System.create" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">create</span><span class="p">(</span><span class="n">path_or_str</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Creates a <code>System</code> instance from an XML file or string.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.System.coordinate_vector_to_q" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">coordinate_vector_to_q</span>


<a href="#src.ring.base.System.coordinate_vector_to_q" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">coordinate_vector_to_q</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">custom_joints</span><span class="o">=</span><span class="p">{})</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Converts a coordinate vector to minimal coordinates (<code>q</code>), applying
constraints such as quaternion normalization.</p>

  </div>

</div>



  </div>

  </div>


</div><h3 id="motionconfig">MotionConfig<a class="headerlink" href="#motionconfig" title="Permanent link">¤</a></h3>


<div class="doc doc-object doc-class">



<h4 id="src.ring.algorithms.jcalc.MotionConfig" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">MotionConfig</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#src.ring.algorithms.jcalc.MotionConfig" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents first">

  
      <p>Configuration for joint motion generation in kinematic and dynamic simulations.</p>
<p>This class defines the constraints and parameters for generating random joint motions,
including angular and positional velocity limits, interpolation methods, and range
restrictions for various joint types.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>T</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Total duration of the motion sequence (in seconds).</p>
              </div>
            </li>
            <li>
              <b><code>t_min</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Minimum time interval between two generated joint states.</p>
              </div>
            </li>
            <li>
              <b><code>t_max</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum time interval between two generated joint states.</p>
              </div>
            </li>
            <li>
              <b><code>dang_min</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum angular velocity (rad/s).</p>
              </div>
            </li>
            <li>
              <b><code>dang_max</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum angular velocity (rad/s).</p>
              </div>
            </li>
            <li>
              <b><code>dang_min_free_spherical</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum angular velocity for free and spherical joints.</p>
              </div>
            </li>
            <li>
              <b><code>dang_max_free_spherical</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum angular velocity for free and spherical joints.</p>
              </div>
            </li>
            <li>
              <b><code>delta_ang_min</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum allowed change in joint angle (radians).</p>
              </div>
            </li>
            <li>
              <b><code>delta_ang_max</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum allowed change in joint angle (radians).</p>
              </div>
            </li>
            <li>
              <b><code>delta_ang_min_free_spherical</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum allowed change in angle for free/spherical joints.</p>
              </div>
            </li>
            <li>
              <b><code>delta_ang_max_free_spherical</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum allowed change in angle for free/spherical joints.</p>
              </div>
            </li>
            <li>
              <b><code>dpos_min</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum translational velocity.</p>
              </div>
            </li>
            <li>
              <b><code>dpos_max</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum translational velocity.</p>
              </div>
            </li>
            <li>
              <b><code>pos_min</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum position constraint.</p>
              </div>
            </li>
            <li>
              <b><code>pos_max</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum position constraint.</p>
              </div>
            </li>
            <li>
              <b><code>pos_min_p3d_x</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum position in x-direction for P3D joints.</p>
              </div>
            </li>
            <li>
              <b><code>pos_max_p3d_x</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum position in x-direction for P3D joints.</p>
              </div>
            </li>
            <li>
              <b><code>pos_min_p3d_y</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum position in y-direction for P3D joints.</p>
              </div>
            </li>
            <li>
              <b><code>pos_max_p3d_y</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum position in y-direction for P3D joints.</p>
              </div>
            </li>
            <li>
              <b><code>pos_min_p3d_z</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum position in z-direction for P3D joints.</p>
              </div>
            </li>
            <li>
              <b><code>pos_max_p3d_z</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum position in z-direction for P3D joints.</p>
              </div>
            </li>
            <li>
              <b><code>cdf_bins_min</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Minimum number of bins for cumulative distribution function (CDF)-based random sampling.</p>
              </div>
            </li>
            <li>
              <b><code>cdf_bins_max</code></b>
                  (<code><span title="typing.Optional">Optional</span>[int]</code>)
              –
              <div class="doc-md-description">
                <p>Maximum number of bins for CDF-based sampling.</p>
              </div>
            </li>
            <li>
              <b><code>randomized_interpolation_angle</code></b>
                  (<code>bool</code>)
              –
              <div class="doc-md-description">
                <p>Whether to use randomized interpolation for angular motion.</p>
              </div>
            </li>
            <li>
              <b><code>randomized_interpolation_position</code></b>
                  (<code>bool</code>)
              –
              <div class="doc-md-description">
                <p>Whether to use randomized interpolation for positional motion.</p>
              </div>
            </li>
            <li>
              <b><code>interpolation_method</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Interpolation method to be used (default: "cosine").</p>
              </div>
            </li>
            <li>
              <b><code>range_of_motion_hinge</code></b>
                  (<code>bool</code>)
              –
              <div class="doc-md-description">
                <p>Whether to enforce range-of-motion constraints on hinge joints.</p>
              </div>
            </li>
            <li>
              <b><code>range_of_motion_hinge_method</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Method used for range-of-motion enforcement (e.g., "uniform", "sigmoid").</p>
              </div>
            </li>
            <li>
              <b><code>rom_halfsize</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Half-size of the range of motion restriction.</p>
              </div>
            </li>
            <li>
              <b><code>ang0_min</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Minimum initial joint angle.</p>
              </div>
            </li>
            <li>
              <b><code>ang0_max</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Maximum initial joint angle.</p>
              </div>
            </li>
            <li>
              <b><code>pos0_min</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Minimum initial joint position.</p>
              </div>
            </li>
            <li>
              <b><code>pos0_max</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Maximum initial joint position.</p>
              </div>
            </li>
            <li>
              <b><code>cor_t_min</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Minimum time step for center-of-rotation (COR) joints.</p>
              </div>
            </li>
            <li>
              <b><code>cor_t_max</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum time step for COR joints.</p>
              </div>
            </li>
            <li>
              <b><code>cor_dpos_min</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum velocity for COR translation.</p>
              </div>
            </li>
            <li>
              <b><code>cor_dpos_max</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum velocity for COR translation.</p>
              </div>
            </li>
            <li>
              <b><code>cor_pos_min</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Minimum position for COR translation.</p>
              </div>
            </li>
            <li>
              <b><code>cor_pos_max</code></b>
                  (<code>float | <span title="ring.algorithms._random.TimeDependentFloat">TimeDependentFloat</span></code>)
              –
              <div class="doc-md-description">
                <p>Maximum position for COR translation.</p>
              </div>
            </li>
            <li>
              <b><code>cor_pos0_min</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Initial minimum position for COR translation.</p>
              </div>
            </li>
            <li>
              <b><code>cor_pos0_max</code></b>
                  (<code>float</code>)
              –
              <div class="doc-md-description">
                <p>Initial maximum position for COR translation.</p>
              </div>
            </li>
            <li>
              <b><code>joint_type_specific_overwrites</code></b>
                  (<code>dict[str, dict[str, <span title="typing.Any">Any</span>]]</code>)
              –
              <div class="doc-md-description">
                <p>A dictionary mapping joint types to specific motion configuration overrides.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code><span title="src.ring.algorithms.jcalc.MotionConfig.is_feasible">is_feasible</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Checks if the motion configuration satisfies all constraints.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><span title="src.ring.algorithms.jcalc.MotionConfig.to_nomotion_config">to_nomotion_config</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Returns a new <code>MotionConfig</code> where all velocities and angle changes are set to zero.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.algorithms.jcalc.MotionConfig.overwrite_for_joint_type" href="#src.ring.algorithms.jcalc.MotionConfig.overwrite_for_joint_type">overwrite_for_joint_type</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Applies specific configuration changes for a given joint type.
Note: These changes affect all instances of <code>MotionConfig</code> for this joint type.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.algorithms.jcalc.MotionConfig.overwrite_for_subsystem" href="#src.ring.algorithms.jcalc.MotionConfig.overwrite_for_subsystem">overwrite_for_subsystem</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Modifies the motion configuration for all joints in a subsystem rooted at <code>link_name</code>.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><span title="src.ring.algorithms.jcalc.MotionConfig.from_register">from_register</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Retrieves a predefined <code>MotionConfig</code> from the global registry.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="src.ring.algorithms.jcalc.MotionConfig.overwrite_for_joint_type" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">overwrite_for_joint_type</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.ring.algorithms.jcalc.MotionConfig.overwrite_for_joint_type" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">overwrite_for_joint_type</span><span class="p">(</span><span class="n">joint_type</span><span class="p">,</span> <span class="o">**</span><span class="n">changes</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Changes values of the <code>MotionConfig</code> used by the draw_fn for only a specific
joint.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This applies these changes to <em>all</em> MotionConfigs for this joint type!
This takes precedence <em>over</em> <code>Motionconfig.joint_type_specific_overwrites</code>!</p>
</div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.algorithms.jcalc.MotionConfig.overwrite_for_subsystem" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">overwrite_for_subsystem</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.ring.algorithms.jcalc.MotionConfig.overwrite_for_subsystem" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">overwrite_for_subsystem</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">link_name</span><span class="p">,</span> <span class="o">**</span><span class="n">changes</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Modifies motionconfig of all joints in subsystem with root <code>link_name</code>.
Note that if the subsystem contains a free joint then the jointtype will
will be re-named to <code>free_&lt;link_name&gt;</code>, then the RCMG flag <code>cor</code> will
potentially not work as expected because it searches for all joints of
type <code>free</code> to replace with <code>cor</code>. The workaround here is to change the
type already from <code>free</code> to <code>cor in the xml file.
This takes precedence *over*</code>Motionconfig.joint_type_specific_overwrites`!</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>sys</code></b>
                  (<code><span title="ring.base.System">System</span></code>)
              –
              <div class="doc-md-description">
                <p>System object that gets updated</p>
              </div>
            </li>
            <li>
              <b><code>link_name</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Root node of subsystem</p>
              </div>
            </li>
            <li>
              <b><code>changes</code></b>
              –
              <div class="doc-md-description">
                <p>Changes to apply to the motionconfig</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<details class="return" open>
  <summary>Return</summary>
  <p>base.System: Updated system with new jointtypes</p>
</details>
  </div>

</div>



  </div>

  </div>


</div><hr />



<div class="doc doc-object doc-function">



<h4 id="src.ring.algorithms.jcalc.join_motionconfigs" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">join_motionconfigs</span>


<a href="#src.ring.algorithms.jcalc.join_motionconfigs" class="headerlink" title="Permanent link">¤</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">join_motionconfigs</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents first">
  
      <p>Joins multiple <code>MotionConfig</code> objects in time, transitioning between them at specified boundaries.</p>
<p>This function takes a list of <code>MotionConfig</code> instances and a corresponding list of boundary times,
and constructs a new <code>MotionConfig</code> that varies in time according to the provided segments.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>configs</code></b>
                  (<code>list[<a class="autorefs autorefs-internal" title="src.ring.algorithms.jcalc.MotionConfig" href="#src.ring.algorithms.jcalc.MotionConfig">MotionConfig</a>]</code>)
              –
              <div class="doc-md-description">
                <p>A list of <code>MotionConfig</code> objects to be joined.</p>
              </div>
            </li>
            <li>
              <b><code>boundaries</code></b>
                  (<code>list[float]</code>)
              –
              <div class="doc-md-description">
                <p>A list of time values where transitions between <code>configs</code> occur.
Must have one element less than <code>configs</code>, as each boundary defines the transition point
between two consecutive configurations.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>MotionConfig</code></b>(                <code><a class="autorefs autorefs-internal" title="src.ring.algorithms.jcalc.MotionConfig" href="#src.ring.algorithms.jcalc.MotionConfig">MotionConfig</a></code>
)            –
            <div class="doc-md-description">
              <p>A new <code>MotionConfig</code> object where time-dependent fields transition based on the</p>
            </div>
          </li>
          <li>
                <code><a class="autorefs autorefs-internal" title="src.ring.algorithms.jcalc.MotionConfig" href="#src.ring.algorithms.jcalc.MotionConfig">MotionConfig</a></code>
            –
            <div class="doc-md-description">
              <p>specified boundaries.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>AssertionError</code>
              –
              <div class="doc-md-description">
                <p>If the number of boundaries does not match <code>len(configs) - 1</code>.</p>
              </div>
            </li>
            <li>
                  <code>AssertionError</code>
              –
              <div class="doc-md-description">
                <p>If time-independent fields have differing values across <code>configs</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Only fields that are time-dependent (<code>float | TimeDependentFloat</code>) will change over time.</li>
<li>Time-independent fields must be the same in all <code>configs</code>, or an error is raised.</li>
</ul>
</details>
  </div>

</div><h3 id="extending-the-rcmg">Extending the RCMG<a class="headerlink" href="#extending-the-rcmg" title="Permanent link">¤</a></h3>


<div class="doc doc-object doc-class">



<h4 id="src.ring.algorithms.jcalc.JointModel" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">JointModel</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#src.ring.algorithms.jcalc.JointModel" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents first">

  
      <p>Represents the kinematic and dynamic properties of a joint type.</p>
<p>A <code>JointModel</code> defines the mathematical functions required to compute joint
transformations, motion, control terms, and inverse kinematics. It is used to
describe the behavior of various joint types, including revolute, prismatic,
spherical, and free joints.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>transform</code></b>
                  (<code><span title="typing.Callable">Callable</span>[[<span title="jax.Array">Array</span>, <span title="jax.Array">Array</span>], <span title="ring.base.Transform">Transform</span>]</code>)
              –
              <div class="doc-md-description">
                <p>Computes the transformation (position and orientation) of the joint
given the joint state <code>q</code> and joint parameters.</p>
              </div>
            </li>
            <li>
              <b><code>motion</code></b>
                  (<code>list[<span title="ring.base.Motion">Motion</span> | <span title="typing.Callable">Callable</span>[[<span title="jax.Array">Array</span>], <span title="ring.base.Motion">Motion</span>]]</code>)
              –
              <div class="doc-md-description">
                <p>Defines the joint motion model. It can be a list of <code>Motion</code> objects
or callables that return <code>Motion</code> based on joint parameters.</p>
              </div>
            </li>
            <li>
              <b><code>rcmg_draw_fn</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="src.ring.algorithms.jcalc.DRAW_FN">DRAW_FN</span>]</code>)
              –
              <div class="doc-md-description">
                <p>Function used to generate a reference motion trajectory for the joint
using Randomized Control Motion Generation (RCMG).</p>
              </div>
            </li>
            <li>
              <b><code>p_control_term</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="src.ring.algorithms.jcalc.P_CONTROL_TERM">P_CONTROL_TERM</span>]</code>)
              –
              <div class="doc-md-description">
                <p>Function that computes the proportional control term for the joint.</p>
              </div>
            </li>
            <li>
              <b><code>qd_from_q</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="src.ring.algorithms.jcalc.QD_FROM_Q">QD_FROM_Q</span>]</code>)
              –
              <div class="doc-md-description">
                <p>Function to compute joint velocity (<code>qd</code>) from joint positions (<code>q</code>).</p>
              </div>
            </li>
            <li>
              <b><code>coordinate_vector_to_q</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="src.ring.algorithms.jcalc.COORDINATE_VECTOR_TO_Q">COORDINATE_VECTOR_TO_Q</span>]</code>)
              –
              <div class="doc-md-description">
                <p>Function that maps a coordinate vector to a valid joint state <code>q</code>,
ensuring constraints (e.g., wrapping angles or normalizing quaternions).</p>
              </div>
            </li>
            <li>
              <b><code>inv_kin</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="src.ring.algorithms.jcalc.INV_KIN">INV_KIN</span>]</code>)
              –
              <div class="doc-md-description">
                <p>Function that computes the inverse kinematics for the joint, mapping
a desired transform to joint coordinates <code>q</code>.</p>
              </div>
            </li>
            <li>
              <b><code>init_joint_params</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="src.ring.algorithms.jcalc.INIT_JOINT_PARAMS">INIT_JOINT_PARAMS</span>]</code>)
              –
              <div class="doc-md-description">
                <p>Function that initializes joint-specific parameters.</p>
              </div>
            </li>
            <li>
              <b><code>utilities</code></b>
                  (<code><span title="typing.Optional">Optional</span>[dict[str, <span title="typing.Any">Any</span>]]</code>)
              –
              <div class="doc-md-description">
                <p>Additional utility functions or metadata related to the joint model.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The <code>transform</code> function is essential for computing the joint's spatial
  transformation based on its generalized coordinates.</li>
<li>The <code>motion</code> attribute describes how forces and torques affect the joint.</li>
<li>The <code>rcmg_draw_fn</code> is used for RCMG motion generation.</li>
<li>The <code>coordinate_vector_to_q</code> is critical for maintaining valid joint states.</li>
</ul>
</details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div><hr />



<div class="doc doc-object doc-function">



<h4 id="src.ring.algorithms.jcalc.register_new_joint_type" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">register_new_joint_type</span>


<a href="#src.ring.algorithms.jcalc.register_new_joint_type" class="headerlink" title="Permanent link">¤</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">register_new_joint_type</span><span class="p">(</span><span class="n">joint_type</span><span class="p">,</span> <span class="n">joint_model</span><span class="p">,</span> <span class="n">q_width</span><span class="p">,</span> <span class="n">qd_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents first">
  
      <p>Registers a new joint type with its corresponding <code>JointModel</code> and kinematic properties.</p>
<p>This function allows the addition of custom joint types to the system by associating
them with a <code>JointModel</code>, specifying their state and velocity dimensions, and optionally
overwriting existing joint definitions.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>joint_type</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Name of the new joint type to register.</p>
              </div>
            </li>
            <li>
              <b><code>joint_model</code></b>
                  (<code><a class="autorefs autorefs-internal" title="src.ring.algorithms.jcalc.JointModel" href="#src.ring.algorithms.jcalc.JointModel">JointModel</a></code>)
              –
              <div class="doc-md-description">
                <p>The <code>JointModel</code> instance defining the kinematic and dynamic properties of the joint.</p>
              </div>
            </li>
            <li>
              <b><code>q_width</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Number of generalized coordinates (degrees of freedom) required to represent the joint.</p>
              </div>
            </li>
            <li>
              <b><code>qd_width</code></b>
                  (<code>Optional[int], default=None</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Number of velocity coordinates associated with the joint. Defaults to <code>q_width</code>.</p>
              </div>
            </li>
            <li>
              <b><code>overwrite</code></b>
                  (<code>bool, default=False</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>If <code>True</code>, allows overwriting an existing joint type. Otherwise, raises an error if
the joint type already exists.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>AssertionError</code>
              –
              <div class="doc-md-description">
                <ul>
<li>If <code>joint_type</code> is <code>"default"</code> (reserved name).</li>
<li>If <code>joint_type</code> already exists and <code>overwrite=False</code>.</li>
<li>If <code>qd_width</code> is not provided and does not default to <code>q_width</code>.</li>
<li>If <code>joint_model.motion</code> length does not match <code>qd_width</code>.</li>
</ul>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The function updates global dictionaries that store joint properties, including:</li>
<li><code>_joint_types</code>: Maps joint type names to <code>JointModel</code> instances.</li>
<li><code>base.Q_WIDTHS</code>: Stores the number of state coordinates for each joint type.</li>
<li><code>base.QD_WIDTHS</code>: Stores the number of velocity coordinates for each joint type.</li>
<li>If <code>overwrite=True</code>, existing entries are removed before adding the new joint type.</li>
<li>Ensures consistency between motion definitions and velocity coordinate dimensions.</li>
</ul>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="n">new_joint</span> <span class="o">=</span> <span class="n">JointModel</span><span class="p">(</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">my_transform_fn</span><span class="p">,</span>
    <span class="n">motion</span><span class="o">=</span><span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">Motion</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">ang</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))],</span>
<span class="p">)</span>
<span class="n">register_new_joint_type</span><span class="p">(</span><span class="s2">&quot;custom_hinge&quot;</span><span class="p">,</span> <span class="n">new_joint</span><span class="p">,</span> <span class="n">q_width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</details>
  </div>

</div><h2 id="simulation">Simulation<a class="headerlink" href="#simulation" title="Permanent link">¤</a></h2>


<div class="doc doc-object doc-class">



<h4 id="src.ring.base.State" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">State</span>


<a href="#src.ring.base.State" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents first">

  
      <p>Represents the state of a dynamic system in minimal and maximal coordinates.</p>
<p>The <code>State</code> class encapsulates both the configuration (<code>q</code>) and velocity (<code>qd</code>)
of the system in minimal coordinates, as well as the corresponding transforms (<code>x</code>)
in maximal coordinates.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>q</code></b>
                  (<code><span title="jax.Array">Array</span></code>)
              –
              <div class="doc-md-description">
                <p>The joint positions (generalized coordinates) of the system. The size
of <code>q</code> matches <code>sys.q_size()</code>.</p>
              </div>
            </li>
            <li>
              <b><code>qd</code></b>
                  (<code><span title="jax.Array">Array</span></code>)
              –
              <div class="doc-md-description">
                <p>The joint velocities (generalized velocities) of the system. The size
of <code>qd</code> matches <code>sys.qd_size()</code>.</p>
              </div>
            </li>
            <li>
              <b><code>x</code></b>
                  (<code><a class="autorefs autorefs-internal" title="src.ring.base.Transform" href="#src.ring.base.Transform">Transform</a></code>)
              –
              <div class="doc-md-description">
                <p>The maximal coordinate representation of all system links, expressed as
a <code>Transform</code> object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.State.create" href="#src.ring.base.State.create">create</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>System, q: Optional[jax.Array] = None,
   qd: Optional[jax.Array] = None, x: Optional[Transform] = None,
   key: Optional[jax.Array] = None,
   custom_joints: dict[str, Callable] = {}) -&gt; State:
Creates a <code>State</code> instance for a given system with optional initial conditions.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

<details class="usage" open>
  <summary>Usage</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>sys = System.create("model.xml")
state = State.create(sys)
print(state.q.shape)  # Should match sys.q_size()
print(state.qd.shape)  # Should match sys.qd_size()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="src.ring.base.State.create" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">create</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#src.ring.base.State.create" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">create</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_joints</span><span class="o">=</span><span class="p">{})</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Creates a <code>State</code> instance for the given system with optional initial conditions.</p>
<p>If no initial values are provided, joint positions (<code>q</code>) and velocities (<code>qd</code>)
are initialized to zero, except for free and spherical joints, which have unit quaternions.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>sys</code></b>
                  (<code><a class="autorefs autorefs-internal" title="src.ring.base.System" href="#src.ring.base.System">System</a></code>)
              –
              <div class="doc-md-description">
                <p>The system for which to create a state.</p>
              </div>
            </li>
            <li>
              <b><code>q</code></b>
                  (<code>Optional[jax.Array], default=None</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Initial joint positions. If <code>None</code>, defaults to zeros, with unit quaternion initialization
for free and spherical joints.</p>
              </div>
            </li>
            <li>
              <b><code>qd</code></b>
                  (<code>Optional[jax.Array], default=None</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Initial joint velocities. If <code>None</code>, defaults to zeros.</p>
              </div>
            </li>
            <li>
              <b><code>x</code></b>
                  (<code>Optional[Transform], default=None</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Initial maximal coordinates of the system links. If <code>None</code>, defaults to zero transforms.</p>
              </div>
            </li>
            <li>
              <b><code>key</code></b>
                  (<code>Optional[jax.Array], default=None</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Random key for initializing <code>q</code> if no values are provided.</p>
              </div>
            </li>
            <li>
              <b><code>custom_joints</code></b>
                  (<code>dict[str, Callable], default={}</code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Custom joint functions for mapping coordinate vectors to minimal coordinates.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>State</code></b>(                <code><a class="autorefs autorefs-internal" title="src.ring.base.State" href="#src.ring.base.State">State</a></code>
)            –
            <div class="doc-md-description">
              <p>A new instance of the <code>State</code> class representing the initialized system state.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>sys = System.create("model.xml")
state = State.create(sys)
print(state.q.shape)  # Should match sys.q_size()
print(state.qd.shape)  # Should match sys.qd_size()</p>
</blockquote>
</blockquote>
</blockquote>
</details>
  </div>

</div>



  </div>

  </div>


</div><hr />



<div class="doc doc-object doc-function">



<h4 id="src.ring.algorithms.dynamics.step" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">step</span>


<a href="#src.ring.algorithms.dynamics.step" class="headerlink" title="Permanent link">¤</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">step</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">taus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_substeps</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents first">
  
      <p>Advances the system dynamics by a single timestep using semi-implicit Euler integration.</p>
<p>This function updates the system's state by integrating the equations of motion
over a timestep, potentially with multiple substeps for improved numerical stability.
The method ensures that the system's kinematics are updated before each integration step.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>sys</code></b>
                  (<code><span title="ring.base.System">System</span></code>)
              –
              <div class="doc-md-description">
                <p>The system to simulate, containing link information, joint dynamics, and integration parameters.</p>
              </div>
            </li>
            <li>
              <b><code>state</code></b>
                  (<code><span title="ring.base.State">State</span></code>)
              –
              <div class="doc-md-description">
                <p>The current state of the system, including joint positions (<code>q</code>), velocities (<code>qd</code>), and transforms (<code>x</code>).</p>
              </div>
            </li>
            <li>
              <b><code>taus</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="jax.Array">Array</span>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The control torques applied to the system joints. If <code>None</code>, zero torques are applied.
Defaults to <code>None</code>.</p>
              </div>
            </li>
            <li>
              <b><code>n_substeps</code></b>
                  (<code>int</code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>The number of integration substeps per timestep to improve numerical accuracy.
Defaults to <code>1</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
                <code><span title="ring.base.State">State</span></code>
            –
            <div class="doc-md-description">
              <p>base.State:
The updated state of the system after integration.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>AssertionError</code>
              –
              <div class="doc-md-description">
                <p>If the system's degrees of freedom (<code>q</code> and <code>qd</code>) do not match expectations.</p>
              </div>
            </li>
            <li>
                  <code>AssertionError</code>
              –
              <div class="doc-md-description">
                <p>If an unsupported integration method is specified in <code>sys.integration_method</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
  </div>

</div><hr />


<div class="doc doc-object doc-class">



<h4 id="src.ring.base.Transform" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Transform</span>


<a href="#src.ring.base.Transform" class="headerlink" title="Permanent link">¤</a></h4>


  <div class="doc doc-contents first">

  
      <p>Represents a spatial transformation between two coordinate frames using Plücker coordinates.</p>
<p>The <code>Transform</code> class defines the relative position and orientation of one frame (<code>B</code>)
with respect to another frame (<code>A</code>). The position (<code>pos</code>) is given in the coordinate frame
of <code>A</code>, and the rotation (<code>rot</code>) is expressed as a unit quaternion representing the relative
rotation from frame <code>A</code> to frame <code>B</code>.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>pos</code></b>
                  (<code><span title="src.ring.base.Vector">Vector</span></code>)
              –
              <div class="doc-md-description">
                <p>The translation vector (position of <code>B</code> relative to <code>A</code>) in the coordinate frame of <code>A</code>.
Shape: <code>(..., 3)</code>, where <code>...</code> represents optional batch dimensions.</p>
              </div>
            </li>
            <li>
              <b><code>rot</code></b>
                  (<code><span title="src.ring.base.Quaternion">Quaternion</span></code>)
              –
              <div class="doc-md-description">
                <p>The unit quaternion representing the orientation of <code>B</code> relative to <code>A</code>.
Shape: <code>(..., 4)</code>, where <code>...</code> represents optional batch dimensions.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.Transform.create" href="#src.ring.base.Transform.create">create</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Optional[Vector] = None, rot: Optional[Quaternion] = None) -&gt; Transform:
Creates a <code>Transform</code> instance with optional position and rotation.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.Transform.zero" href="#src.ring.base.Transform.zero">zero</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Sequence[int] = ()) -&gt; Transform:
Returns a zero transform with a given batch shape.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="src.ring.base.Transform.as_matrix" href="#src.ring.base.Transform.as_matrix">as_matrix</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Returns the 4x4 homogeneous transformation matrix representation of this transform.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

<details class="usage" open>
  <summary>Usage</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>pos = jnp.array([1.0, 2.0, 3.0])
rot = jnp.array([1.0, 0.0, 0.0, 0.0])  # Identity quaternion
T = Transform.create(pos, rot)
print(T.pos)  # Output: [1. 2. 3.]
print(T.rot)  # Output: [1. 0. 0. 0.]
print(T.as_matrix())  # 4x4 transformation matrix</p>
</blockquote>
</blockquote>
</blockquote>
</details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="src.ring.base.Transform.create" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">create</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#src.ring.base.Transform.create" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">create</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Creates a <code>Transform</code> instance with the specified position and rotation.</p>
<p>At least one of <code>pos</code> or <code>rot</code> must be provided. If only <code>pos</code> is given, the rotation
defaults to the identity quaternion <code>[1, 0, 0, 0]</code>. If only <code>rot</code> is given, the position
defaults to <code>[0, 0, 0]</code>.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>pos</code></b>
                  (<code>Optional[Vector], default=None</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The position of frame <code>B</code> relative to frame <code>A</code>, expressed in frame <code>A</code> coordinates.
If <code>None</code>, defaults to a zero vector of shape <code>(3,)</code>.</p>
              </div>
            </li>
            <li>
              <b><code>rot</code></b>
                  (<code>Optional[Quaternion], default=None</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The unit quaternion representing the orientation of <code>B</code> relative to <code>A</code>.
If <code>None</code>, defaults to the identity quaternion <code>(1, 0, 0, 0)</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>Transform</code></b>            –
            <div class="doc-md-description">
              <p>A new <code>Transform</code> instance with the specified position and rotation.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>pos = jnp.array([1.0, 2.0, 3.0])
rot = jnp.array([1.0, 0.0, 0.0, 0.0])  # Identity quaternion
T = Transform.create(pos, rot)
print(T.pos)  # Output: [1. 2. 3.]
print(T.rot)  # Output: [1. 0. 0. 0.]</p>
</blockquote>
</blockquote>
</blockquote>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.Transform.zero" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">zero</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#src.ring.base.Transform.zero" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">zero</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">())</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a zero transform with a given batch shape.</p>
<p>This creates a transform with position <code>(0, 0, 0)</code> and an identity quaternion <code>(1, 0, 0, 0)</code>,
which represents no translation or rotation.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>shape</code></b>
                  (<code>Sequence[int], default=</code>, default:
                      <code>()</code>
)
              –
              <div class="doc-md-description">
                <p>The batch shape for the transform. Defaults to a scalar transform.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
<b><code>Transform</code></b>(                <code><a class="autorefs autorefs-internal" title="src.ring.base.Transform" href="#src.ring.base.Transform">Transform</a></code>
)            –
            <div class="doc-md-description">
              <p>A zero transform with the specified batch shape.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>T = Transform.zero()
print(T.pos)  # Output: [0. 0. 0.]
print(T.rot)  # Output: [1. 0. 0. 0.]</p>
</blockquote>
</blockquote>
</blockquote>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="src.ring.base.Transform.as_matrix" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">as_matrix</span>


<a href="#src.ring.base.Transform.as_matrix" class="headerlink" title="Permanent link">¤</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">as_matrix</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the 4x4 homogeneous transformation matrix representation of this transform.</p>
<p>The homogeneous transformation matrix is defined as:</p>
<div class="highlight"><pre><span></span><code>[ R  t ]
[ 0  1 ]
</code></pre></div>
<p>where <code>R</code> is the 3x3 rotation matrix converted from the quaternion and <code>t</code> is the
3x1 position vector.</p>



<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
      <ul class="first simple">
          <li>
                <code><span title="jax.Array">Array</span></code>
            –
            <div class="doc-md-description">
              <p>jax.Array: A <code>(4, 4)</code> homogeneous transformation matrix.</p>
            </div>
          </li>
      </ul>
    </td>
    </tr>
  </tbody>
</table>
<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>T = Transform.create(jnp.array([1.0, 2.0, 3.0]), jnp.array([1.0, 0.0, 0.0, 0.0]))
print(T.as_matrix())  # Output: 4x4 matrix</p>
</blockquote>
</blockquote>
</blockquote>
</details>
  </div>

</div>



  </div>

  </div>


</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../xml_syntax/" class="btn btn-neutral float-left" title="XML Syntax Documentation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../notebooks/getting_started/" class="btn btn-neutral float-right" title="Getting started">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../xml_syntax/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../notebooks/getting_started/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../javascripts/mathjax.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
